<!DOCTYPE html>
<html lang="fi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Uusi blogipostaus</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/tinymce@7.1.0/tinymce.min.js"></script>
</head>
<body>
  <h1>Luo uusi blogipostaus</h1>

  <label for="title">Otsikko:</label>
<input type="text" id="title" placeholder="Kirjoita otsikko" style="width:100%; padding:8px; margin-bottom:10px;">

  <textarea id="editor"></textarea>
  <button id="saveBtn">Tallenna postaus</button>

  <p><a href="blog.html">Näytä kaikki julkaisut</a></p>

  <script>
    tinymce.init({ selector: '#editor', height: 300 });

    document.getElementById('saveBtn').addEventListener('click', async () => {
      const title = document.getElementById('title').value.trim();
      const content = tinymce.get('editor').getContent();

      if (!title || !content) {
        alert('Otsikko ja sisältö ovat pakollisia.');
        return;
      }

      const res = await fetch('/api/posts', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ title, content })
      });

      const data = await res.json();
      alert(data.message);
      document.getElementById('title').value = '';
      tinymce.get('editor').setContent('');
    });
  </script>
</body>
</html>
